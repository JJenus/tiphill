(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[850],{2673:function(e,t,s){"use strict";s.r(t);var i=s(0),n=s.n(i),c=s(994),r=s(885),o=s(23),a=s(28),l=s(34);function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){n()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var p={mixins:[c.a,r.a],props:{game_id:{required:!0,type:Number},game_events:{required:!0,type:Array}},constants:{NAMES_RUS_PERIOD_TYPES:{0:"Моментальные уведомления",2:"Информация по игре"},NAMES_RUS_EVENT_TYPES:{0:"Счет",1:"Желтые карточки",2:"Угловые"}},data:function(){return{show_list:!1,selected_events:[],xhr:null}},computed:_(_({},Object(l.mapGetters)(a.d,["globalIsUserAuth","globalGetUserId"])),{},{$_active_subscription:function(){return!!this.selected_events.length},$_src:function(){return this.$_is_live?0:1}}),mounted:function(){this.game_events.length&&this.getEventsSubscription()},methods:{toggleVisible:function(){this.globalIsUserAuth?(this.show_list=!this.show_list,this.$analytics.eventPage.clickOnNotificationsTab(this.$route.params.section)):Object(o.d)(this.$T("pleaseAuthBell"))},isActivePeriodType:function(e){return-1!==this.selected_events.findIndex((function(t){return t.PeriodType===e}))},isActiveEventType:function(e,t){var s=this.selected_events.find((function(t){return t.PeriodType===e}));return s&&-1!==s.EventType.indexOf(t)},selectPeriodType:function(e){var t=this.selected_events.findIndex((function(t){return t.PeriodType===e.TypePeriod.key}));-1!==t?this.selected_events.splice(t,1):(this.selected_events.push({EventType:e.TypesEvent.map((function(e){return e.Key})),PeriodType:e.TypePeriod.key}),this.$analytics.eventPage.toggleItemNotifications(this.$consts.NAMES_RUS_PERIOD_TYPES[e.TypePeriod.key]))},selectEventType:function(e,t){var s=this.selected_events.findIndex((function(t){return t.PeriodType===e}));if(-1!==s){var i=this.selected_events[s].EventType.indexOf(t);-1!==i?1===this.selected_events[s].EventType.length?this.selected_events.splice(s,1):this.selected_events[s].EventType.splice(i,1):this.selected_events[s].EventType.push(t)}else this.selected_events.push({EventType:[t],PeriodType:e});this.selected_events.length>0&&this.$analytics.eventPage.toggleItemNotifications(this.$consts.NAMES_RUS_EVENT_TYPES[t])},saveGameSubscription:function(){var e=this;if(!this.globalIsUserAuth)return this.show_list=!1,void Object(o.g)(this.$T("need_reg_auth"));if(null===this.xhr){var t={events:this.selected_events,game_id:this.game_id,src:this.$_src};this.xhr=!0,this.$http.post("/gamesubscription/save",t).then((function(t){e.xhr=null,t.data.msg&&(e.show_list=!1,Object(o.g)(t.data.msg))})).catch(console.warn),this.$analytics.eventPage.clickOnSaveNotificationsButton(this.$route.params.section)}},clearEvents:function(){this.selected_events=[],this.$analytics.eventPage.clickOnClearNotificationsButton(this.$route.params.section)},getEventsSubscription:function(){var e=this;if(this.globalIsUserAuth){var t={GameId:this.game_id,UserId:this.globalGetUserId,Source:this.$_src};this.$http.post("/SubService/api/GetGameSubscription",t).then((function(t){var s=t.data;e.selected_events=s})).catch(console.warn)}}}},v=s(19),h=Object(v.a)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tabs__item"},[s("a",{staticClass:"game-info__stat game-info__stat--bell",class:{active:e.$_active_subscription},on:{click:e.toggleVisible}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.show_list,expression:"show_list"}],staticClass:"subscription"},[s("div",{staticClass:"subscription-nav"},[s("a",{staticClass:"subscription-nav__link subscription-nav__link--close",on:{click:e.toggleVisible}},[e._v("x")])]),e._v(" "),s("div",{staticClass:"subscription__scroll"},[s("div",{staticClass:"subscription__wrap"},[e._l(e.game_events,(function(t){return[s("div",{staticClass:"subscription__notification"},[s("div",{staticClass:"subscription__item"},[s("p",{staticClass:"subscription__title subscription__check",class:{active:e.isActivePeriodType(t.TypePeriod.key)},on:{click:function(s){return e.selectPeriodType(t)}}},[e._v("\n                                "+e._s(t.TypePeriod.value)+"\n                            ")])])]),e._v(" "),s("div",{staticClass:"subscription__notification"},e._l(t.TypesEvent,(function(i){return s("p",{staticClass:"subscription__item",on:{click:function(s){return e.selectEventType(t.TypePeriod.key,i.Key)}}},[s("span",{staticClass:"subscription__text subscription__check",class:{active:e.isActiveEventType(t.TypePeriod.key,i.Key)}},[e._v(e._s(i.Value))])])})),0)]}))],2),e._v(" "),s("div",{staticClass:"subscription__control"},[s("button",{staticClass:"subscription__link",on:{click:function(t){return e.saveGameSubscription()}}},[e._v("\n                    "+e._s(e.$T("save"))+"\n                ")]),e._v(" "),s("button",{staticClass:"subscription__link subscription__link--clear",attrs:{disabled:!e.selected_events.length},on:{click:function(t){return e.clearEvents()}}},[e._v("\n                    "+e._s(e.$T("clear"))+"\n                ")])])])])])}),[],!1,null,null,null);t.default=h.exports}}]);